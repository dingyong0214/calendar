"use strict";import{XL0,XL0_xzb,XL1,nutB,dt_at}from"./base";export default function Lunargz(i){try{let t=new Date(i).getTime();if(isNaN(t))throw"输入时间不正确";return this.time=t,this.init()}catch(i){throw i}};Lunargz.prototype={rad:648e3/Math.PI,pi2:2*Math.PI,cs_rEar:6378.1366,cs_k:.2725076,cs_sMoon:()=>this.cs_k*this.cs_rEar*1.0000036*this.rad,J2000:2451545,init(i,t){return this.ssqinit(),this.gzTime()},gzTime(){var i=this.Format(this.time,"YYYY:MM:DD:HH:mm:ss").split(":");let t=this.yueLiCalc(Number(i[0]),Number(i[1]));var h=t.lun[Number(i[2])-1],e={};if(e.jq=t.yjd,e.time=i,e.week=this.tranweek(h.week),e.lunar=[h.Lyear2,h.Lmc,h.Ldc,this.tranday(Number(i[3]))],e.gz=[h.Lyear2,h.Lmonth2,h.Lday2],Number(i[3])>=23){var s=this.Format(this.time+864e5,"YYYY:MM:DD:HH:mm:ss").split(":"),a=this.yueLiCalc(Number(s[0]),Number(s[1])).lun[Number(s[2])-1];e.lunar[2]=a.Ldc,e.gz[2]=a.Lday2,e.lunar[3]=this.tranday(Number(s[3]))}if(h.jqmc&&h.jqmc==t.yjd[0].jq){console.log("节气分界日",h.jqsj);var r=new Date(i[0]+"-"+i[1]+"-"+i[2]+" "+h.jqsj).valueOf();this.time<r&&(e.gz[1]=t.lun[Number(i[2]-2)].Lmonth2,"立春"==h.jqmc&&(e.gz[0]=t.lun[Number(i[2]-2)].Lyear2,e.lunar[0]=t.lun[Number(i[2]-2)].Lyear2))}var n=new Date(t.yjd[0].time).valueOf();if(this.time>=n){var c=this.Format(this.time+24*this._getday(i,1)*60*60*1e3,"YYYY:MM:DD:HH:mm:ss").split(":"),g=this.yueLiCalc(Number(c[0]),Number(c[1]));n=new Date(g.yjd[0].time).valueOf(),e.jq[1]=g.yjd[0]}else if(this.time<n){var k=this.Format(this.time-24*this._getday(i,0)*60*60*1e3,"YYYY:MM:DD:HH:mm:ss").split(":"),o=this.yueLiCalc(Number(k[0]),Number(k[1]));e.jq[1]=e.jq[0],e.jq[0]=o.yjd[0]}var f=this.yueLiCalc(Number(i[0]),2);e.yjq=f.yjd;var d=this.yueLiCalc(Number(i[0])+1,2);e.yjq[1]=d.yjd[0];var l=e.gz[2].substring(0,1);return e.gz[3]=this.trantg(l,e.lunar[3]),e},_getday:(i,t)=>t?i[2]>20?15:28:i[2]>20?40:28,tranweek:function(i){switch(i){case 0:return"星期日";case 1:return"星期一";case 2:return"星期二";case 3:return"星期三";case 4:return"星期四";case 5:return"星期五";case 6:return"星期六"}},tranday:function(i){return i>=23||i<1?"子":i>=1&&i<3?"丑":i>=3&&i<5?"寅":i>=5&&i<7?"卯":i>=7&&i<9?"辰":i>=9&&i<11?"巳":i>=11&&i<13?"午":i>=13&&i<15?"未":i>=15&&i<17?"申":i>=17&&i<19?"酉":i>=19&&i<21?"戌":i>=21&&i<23?"亥":void 0},trantg:function(i,t){var h,e=this.obb.Zhi.indexOf(t);"甲"==i||"己"==i?h=this.obb.Gan.indexOf("甲"):"乙"==i||"庚"==i?h=this.obb.Gan.indexOf("丙"):"丙"==i||"辛"==i?h=this.obb.Gan.indexOf("戊"):"丁"==i||"壬"==i?h=this.obb.Gan.indexOf("庚"):"戊"!=i&&"癸"!=i||(h=this.obb.Gan.indexOf("壬"));var s=e+h>9?e+h-10:e+h;return this.obb.Gan[s]+t},yueLiCalc(i,t){var h,e,s,a,r,n,c,g,k,o,f=new Array;for(h=0;h<31;h++)f[h]=new Object;f.dn=0,this._JD.h=12,this._JD.m=0,this._JD.s=.1,this._JD.Y=i,this._JD.M=t,this._JD.D=1,r=this.int2(this.toJD())-this.J2000,this._JD.M++,this._JD.M>12&&(this._JD.Y++,this._JD.M=1),n=this.int2(this.toJD())-this.J2000-r,this.w0=(r+this.J2000+1+7e6)%7,this.y=i,this.m=t,this.d0=r,this.dn=n,a=i-1984+12e3,this.Ly=this.obb.Gan[a%10]+this.obb.Zhi[a%12],this.ShX=this.obb.ShX[a%12];var d=[];for(e=0,s=0;e<n;e++){(k=f[e]).d0=r+e,k.di=e,k.y=i,k.m=t,k.dn=n,k.week0=this.w0,k.week=(this.w0+e)%7,k.weeki=this.int2((this.w0+e)/7),k.weekN=this.int2((this.w0+n-1)/7)+1,this.setFromJD(k.d0+this.J2000),k.d=this._JD.D,(!this.SSQ.ZQ.length||k.d0<this.SSQ.ZQ[0]||k.d0>=this.SSQ.ZQ[24])&&this.calcY(k.d0);var l=this.int2((k.d0-this.SSQ.HS[0])/30);l<13&&this.SSQ.HS[l+1]<=k.d0&&l++,k.Ldi=k.d0-this.SSQ.HS[l],k.Ldc=this.obb.rmc[k.Ldi],k.cur_dz=k.d0-this.SSQ.ZQ[0],k.cur_xz=k.d0-this.SSQ.ZQ[12],k.cur_lq=k.d0-this.SSQ.ZQ[15],k.cur_mz=k.d0-this.SSQ.ZQ[11],k.cur_xs=k.d0-this.SSQ.ZQ[13],k.d0==this.SSQ.HS[l]||k.d0==r?(k.Lmc=this.SSQ.ym[l],k.Ldn=this.SSQ.dx[l],k.Lleap=this.SSQ.leap&&this.SSQ.leap==l?"闰":"",k.Lmc2=l<13?this.SSQ.ym[l+1]:"未知"):(o=f[e-1],k.Lmc=o.Lmc,k.Ldn=o.Ldn,k.Lleap=o.Lleap,k.Lmc2=o.Lmc2);var F=this.int2((k.d0-this.SSQ.ZQ[0]-7)/15.2184);for(F<23&&k.d0>=this.SSQ.ZQ[F+1]&&F++,k.d0==this.SSQ.ZQ[F]?k.Ljq=this.obb.jqmc[F]:k.Ljq="",k.yxmc=k.yxjd=k.yxsj="",k.jqmc=k.jqjd=k.jqsj="",c=this.SSQ.ZQ[3]+(k.d0<this.SSQ.ZQ[3]?-365:0)+5844-35,k.Lyear=Math.floor(c/365.2422+.5),c=this.SSQ.HS[2],s=0;s<14;s++)if(!("正"!=this.SSQ.ym[s]||this.SSQ.leap==s&&s)&&(c=this.SSQ.HS[s],k.d0<c)){c-=365;break}c+=5810,k.Lyear0=Math.floor(c/365.2422+.5),c=k.Lyear+12e3,k.Lyear2=this.obb.Gan[c%10]+this.obb.Zhi[c%12],c=k.Lyear0+12e3,k.Lyear3=this.obb.Gan[c%10]+this.obb.Zhi[c%12],k.Lyear4=k.Lyear0+1984+2698,(l=this.int2((k.d0-this.SSQ.ZQ[0])/30.43685))<12&&k.d0>=this.SSQ.ZQ[2*l+1]&&l++,c=l+12*this.int2((this.SSQ.ZQ[12]+390)/365.2422)+9e5,k.Lmonth=c%12,k.Lmonth2=this.obb.Gan[c%10]+this.obb.Zhi[c%12],c=k.d0-6+9e6,k.Lday2=this.obb.Gan[c%10]+this.obb.Zhi[c%12],(l=this.int2((k.d0-this.SSQ.ZQ[0]-15)/30.43685))<11&&k.d0>=this.SSQ.ZQ[2*l+2]&&l++,k.XiZ=this.obb.XiZ[(l+12)%12]+"座",k.A=k.B=k.C="",k.Fjia=0}var _,u,S=r+this.dt_T(r)-8/24;g=this.MS_aLon(S/36525,10,3),g=this.int2((g-.78)/Math.PI*2)*Math.PI/2;do{if(_=this.so_accurate(g),c=this.int2(_+.5),u=this.int2(g/this.pi2*4+4000000.01)%4,g+=this.pi2/4,c>=r+n)break;c<r||((k=f[c-r]).yxmc=this.obb.yxmc[u],k.yxjd=_,k.yxsj=this.timeStr(_))}while(c+5<r+n);g=this.S_aLon(S/36525,3),g=this.int2((g-.13)/this.pi2*24)*this.pi2/24;do{if(_=this.qi_accurate(g),c=this.int2(_+.5),u=this.int2(g/this.pi2*24+24000006.01)%24,g+=this.pi2/24,c>=r+n)break;c<r||((k=f[c-r]).jqmc=this.obb.jqmc[u],k.jqjd=_,k.jqsj=this.timeStr(_),d.push({time:k.y+"-"+k.m+"-"+k.d+" "+k.jqsj,jq:k.jqmc}))}while(c+12<r+n);return{lun:f,yjd:d}},substr2:(i,t,h)=>(i=i.replace(/(^\s*)|(\s*$)/g,"")).length>t+1?i.substr(0,t)+h:i,int2:i=>Math.floor(i),XL0_calc(i,t,h,e){h/=10;var s,a,r,n,c,g,k,o=0,f=1,d=XL0[i],l=6*t+1,F=d[l+1]-d[l];for(s=0;s<6;s++,f*=h)if(n=d[l+s],k=(c=d[l+1+s])-n){for(e<0?g=c:(g=this.int2(3*e*k/F+.5)+n,s&&(g+=3),g>c&&(g=c)),a=n,r=0;a<g;a+=3)r+=d[a]*Math.cos(d[a+1]+h*d[a+2]);o+=r*f}if(o/=d[0],0==i){var _=h*h,u=_*h;0==t&&(o+=(-.0728-2.7702*h-1.1019*_-.0996*u)/this.rad),1==t&&(o+=(0+4e-4*h+4e-4*_-.0026*u)/this.rad),2==t&&(o+=(.0044*h-.002+.0213*_-.025*u)/1e6)}else{var S=XL0_xzb[3*(i-1)+t];0==t&&(o+=-3*h/this.rad),o+=2==t?S/1e6:S/this.rad}return o},gxc_moonLon:i=>-34e-7,gxc_sunLon(i){var t=628.301955*i-.043126-2732e-9*i*i;return-20.49552*(1+(.016708634-42037e-9*i-1.267e-7*i*i)*Math.cos(t))/this.rad},nutationLon2(i){var t,h,e=i*i,s=0,a=nutB;for(t=0;t<a.length;t+=5)h=0==t?-1.742*i:0,s+=(a[t+3]+h)*Math.sin(a[t]+a[t+1]*i+a[t+2]*e);return s/100/this.rad},XL1_calc(i,t,h){var e,s,a,r,n,c=XL1[i],g=0,k=1,o=t*t,f=o*t,d=f*t,l=d*t,F=t-10;for(0==i&&(g+=(3.81034409+8399.684730072*t-3319e-8*o+3.11e-8*f-2.033e-10*d)*this.rad,g+=5028.792262*t+1.1124406*o+7699e-8*f-23479e-9*d-1.78e-8*l,F>0&&(g+=1.43*F-.866+.054*F*F)),o/=1e4,f/=1e8,d/=1e8,(h*=6)<0&&(h=c[0].length),e=0;e<c.length;e++,k*=t){for(a=c[e],r=this.int2(h*a.length/c[0].length+.5),e&&(r+=6),r>=a.length&&(r=a.length),s=0,n=0;s<r;s+=6)n+=a[s]*Math.cos(a[s+1]+t*a[s+2]+o*a[s+3]+f*a[s+4]+d*a[s+5]);g+=n*k}return 2!=i&&(g/=this.rad),g},dt_ext(i,t){var h=(i-1820)/100;return t*h*h-20},dt_calc(i){var t=dt_at[dt_at.length-2],h=dt_at[dt_at.length-1];if(i>=t){return i>t+100?this.dt_ext(i,31):this.dt_ext(i,31)-(this.dt_ext(t,31)-h)*(t+100-i)/100}var e,s=dt_at;for(e=0;e<s.length&&!(i<s[e+5]);e+=5);var a=(i-s[e])/(s[e+5]-s[e])*10,r=a*a,n=r*a;return s[e+1]+s[e+2]*a+s[e+3]*r+s[e+4]*n},dt_T(i){return this.dt_calc(i/365.2425+2e3)/86400},Format:function(i,t){var h=new Date(i),e={"M+":h.getMonth()+1,"D+":h.getDate(),"H+":h.getHours(),"m+":h.getMinutes(),"s+":h.getSeconds(),"q+":Math.floor((h.getMonth()+3)/3),S:h.getMilliseconds()};for(var s in/(Y+)/.test(t)&&(t=t.replace(RegExp.$1,(h.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[s]:("00"+e[s]).substr((""+e[s]).length)));return t},obb:{numCn:new Array("零","一","二","三","四","五","六","七","八","九","十"),Gan:new Array("甲","乙","丙","丁","戊","己","庚","辛","壬","癸"),Zhi:new Array("子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"),ShX:new Array("鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"),XiZ:new Array("摩羯","水瓶","双鱼","白羊","金牛","双子","巨蟹","狮子","处女","天秤","天蝎","射手"),yxmc:new Array("朔","上弦","望","下弦"),jqmc:new Array("冬至","小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪"),ymc:new Array("十一","十二","正","二","三","四","五","六","七","八","九","十"),rmc:new Array("初一","初二","初三","初四","初五","初六","初七","初八","初九","初十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十","卅一")},qi_accurate(i){var t=36525*this.S_aLon_t(i);return t-this.dt_T(t)+8/24},so_accurate(i){var t=36525*this.MS_aLon_t(i);return t-this.dt_T(t)+8/24},qi_accurate2(i){var t=Math.PI/12,h=Math.floor((i+293)/365.2422*24)*t,e=this.qi_accurate(h);return e-i>5?this.qi_accurate(h-t):e-i<-5?this.qi_accurate(h+t):e},so_accurate2(i){return this.so_accurate(Math.floor((i+8)/29.5306)*Math.PI*2)},SSQ:{SB:"",QB:"",suoKB:new Array(1457698.231017,29.53067166,1546082.512234,29.53085106,1640640.7353,29.5306,1642472.151543,29.53085439,1683430.5093,29.53086148,1752148.041079,29.53085097,1807665.420323,29.53059851,1883618.1141,29.5306,1907360.7047,29.5306,1936596.2249,29.5306,1939135.6753,29.5306,1947168),qiKB:new Array(1640650.479938,15.218425,1642476.703182,15.21874996,1683430.515601,15.218750011,1752157.640664,15.218749978,1807675.003759,15.218620279,1883627.765182,15.218612292,1907369.1281,15.218449176,1936603.140413,15.218425,1939145.52418,15.218466998,1947180.7983,15.218524844,1964362.041824,15.218533526,1987372.340971,15.218513908,1999653.819126,15.218530782,2007445.469786,15.218535181,2021324.917146,15.218526248,2047257.232342,15.218519654,2070282.898213,15.218425,2073204.87285,15.218515221,2080144.500926,15.218530782,2086703.688963,15.218523776,2110033.182763,15.218425,2111190.300888,15.218425,2113731.271005,15.218515671,2120670.840263,15.218425,2123973.309063,15.218425,2125068.997336,15.218477932,2136026.312633,15.218472436,2156099.495538,15.218425,2159021.324663,15.218425,2162308.575254,15.218461742,2178485.706538,15.218425,2178759.662849,15.218445786,2185334.0208,15.218425,2187525.481425,15.218425,2188621.191481,15.218437494,2322147.76),leap:0,ym:new Array,ZQ:new Array,HS:new Array,dx:new Array,Yn:new Array},calcY(i){var t,h,e,s=this.SSQ.ZQ,a=this.SSQ.HS;for(h=365.2422*this.int2((i-355+183)/365.2422)+355,this.calc(h,"气")>i&&(h-=365.2422),t=0;t<25;t++)s[t]=this.calc(h+15.2184*t,"气");for(s.pe1=this.calc(h-15.2,"气"),s.pe2=this.calc(h-30.4,"气"),(e=this.calc(s[0],"朔"))>s[0]&&(e-=29.53),t=0;t<15;t++)a[t]=this.calc(e+29.5306*t,"朔");for(this.SSQ.leap=0,t=0;t<14;t++)this.SSQ.dx[t]=this.SSQ.HS[t+1]-this.SSQ.HS[t],this.SSQ.ym[t]=t;var r=this.int2((this.SSQ.ZQ[0]+10+180)/365.2422)+2e3;if(r>=-721&&r<=-104){var n,c,g,k=new Array;for(t=0;t<3;t++)(n=r+t-1)>=-721&&(k[t]=this.calc(1457698-this.J2000+29.5306*this.int2(.342+12.368422*(n+721)),"朔"),k[t+3]="十三",k[t+6]=2),n>=-479&&(k[t]=this.calc(1546083-this.J2000+29.5306*this.int2(.5+12.368422*(n+479)),"朔"),k[t+3]="十三",k[t+6]=2),n>=-220&&(k[t]=this.calc(1640641-this.J2000+29.5306*this.int2(.866+12.369*(n+220)),"朔"),k[t+3]="后九",k[t+6]=11);for(t=0;t<14;t++){for(c=2;c>=0&&!(this.SSQ.HS[t]>=k[c]);c--);g=this.int2((this.SSQ.HS[t]-k[c]+15)/29.5306),this.SSQ.ym[t]=g<12?this.obb.ymc[(g+k[c+6])%12]:k[c+3]}}else{if(a[13]<=s[24]){for(t=1;a[t+1]>s[2*t]&&t<13;t++);for(this.SSQ.leap=t;t<14;t++)this.SSQ.ym[t]--}for(t=0;t<14;t++){var o=this.SSQ.HS[t]+this.J2000,f=this.SSQ.ym[t],d=this.obb.ymc[f%12];o>=1724360&&o<=1729794?d=this.obb.ymc[(f+1)%12]:o>=1807724&&o<=1808699?d=this.obb.ymc[(f+1)%12]:o>=1999349&&o<=1999467?d=this.obb.ymc[(f+2)%12]:o>=1973067&&o<=1977052&&(f%12==0&&(d="正"),2==f&&(d="一")),1729794!=o&&1808699!=o||(d="拾贰"),this.SSQ.ym[t]=d}}},so_low(i){var t=7771.37714500204,h=(i+1.08472)/t;return 36525*(h-=(-331e-7*h*h+.10976*Math.cos(.785+8328.6914*h)+.02224*Math.cos(.187+7214.0629*h)-.03342*Math.cos(4.669+628.3076*h))/t+(32*(h+1.8)*(h+1.8)-20)/86400/36525)+8/24},qi_low(i){var t,h=628.3319653318;return t=(i-4.895062166)/h,t-=(53*t*t+334116*Math.cos(4.67+628.307585*t)+2061*Math.cos(2.678+628.3076*t)*t)/h/1e7,36525*(t-=((48950621.66+6283319653.318*t+53*t*t+334166*Math.cos(4.669257+628.307585*t)+3489*Math.cos(4.6261+1256.61517*t)+2060.6*Math.cos(2.67823+628.307585*t)*t-994-834*Math.sin(2.1824-33.75705*t))/1e7-i)/628.332+(32*(t+1.8)*(t+1.8)-20)/86400/36525)+8/24},qi_high(i){var t=36525*this.S_aLon_t2(i),h=((t=t-this.dt_T(t)+8/24)+.5)%1*86400;return(h<1200||h>85200)&&(t=36525*this.S_aLon_t(i)-this.dt_T(t)+8/24),t},so_high(i){var t=36525*this.MS_aLon_t2(i),h=((t=t-this.dt_T(t)+8/24)+.5)%1*86400;return(h<1800||h>84600)&&(t=36525*this.MS_aLon_t(i)-this.dt_T(t)+8/24),t},jieya(i){var t="0000000000",h=t+t;return i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=i.replace(/J/g,"00")).replace(/I/g,"000")).replace(/H/g,"0000")).replace(/G/g,"00000")).replace(/t/g,"02")).replace(/s/g,"002")).replace(/r/g,"0002")).replace(/q/g,"00002")).replace(/p/g,"000002")).replace(/o/g,"0000002")).replace(/n/g,"00000002")).replace(/m/g,"000000002")).replace(/l/g,"0000000002")).replace(/k/g,"01")).replace(/j/g,"0101")).replace(/i/g,"001")).replace(/h/g,"001001")).replace(/g/g,"0001")).replace(/f/g,"00001")).replace(/e/g,"000001")).replace(/d/g,"0000001")).replace(/c/g,"00000001")).replace(/b/g,"000000001")).replace(/a/g,"0000000001")).replace(/A/g,h+h+h)).replace(/B/g,h+h+t)).replace(/C/g,h+h)).replace(/D/g,h+t)).replace(/E/g,h)).replace(/F/g,t)},ssqinit(){this.SSQ.SB=this.jieya("EqoFscDcrFpmEsF2DfFideFelFpFfFfFiaipqti1ksttikptikqckstekqttgkqttgkqteksttikptikq2fjstgjqttjkqttgkqtekstfkptikq2tijstgjiFkirFsAeACoFsiDaDiADc1AFbBfgdfikijFifegF1FhaikgFag1E2btaieeibggiffdeigFfqDfaiBkF1kEaikhkigeidhhdiegcFfakF1ggkidbiaedksaFffckekidhhdhdikcikiakicjF1deedFhFccgicdekgiFbiaikcfi1kbFibefgEgFdcFkFeFkdcfkF1kfkcickEiFkDacFiEfbiaejcFfffkhkdgkaiei1ehigikhdFikfckF1dhhdikcfgjikhfjicjicgiehdikcikggcifgiejF1jkieFhegikggcikFegiegkfjebhigikggcikdgkaFkijcfkcikfkcifikiggkaeeigefkcdfcfkhkdgkegieidhijcFfakhfgeidieidiegikhfkfckfcjbdehdikggikgkfkicjicjF1dbidikFiggcifgiejkiegkigcdiegfggcikdbgfgefjF1kfegikggcikdgFkeeijcfkcikfkekcikdgkabhkFikaffcfkhkdgkegbiaekfkiakicjhfgqdq2fkiakgkfkhfkfcjiekgFebicggbedF1jikejbbbiakgbgkacgiejkijjgigfiakggfggcibFifjefjF1kfekdgjcibFeFkijcfkfhkfkeaieigekgbhkfikidfcjeaibgekgdkiffiffkiakF1jhbakgdki1dj1ikfkicjicjieeFkgdkicggkighdF1jfgkgfgbdkicggfggkidFkiekgijkeigfiskiggfaidheigF1jekijcikickiggkidhhdbgcfkFikikhkigeidieFikggikhkffaffijhidhhakgdkhkijF1kiakF1kfheakgdkifiggkigicjiejkieedikgdfcggkigieeiejfgkgkigbgikicggkiaideeijkefjeijikhkiggkiaidheigcikaikffikijgkiahi1hhdikgjfifaakekighie1hiaikggikhkffakicjhiahaikggikhkijF1kfejfeFhidikggiffiggkigicjiekgieeigikggiffiggkidheigkgfjkeigiegikifiggkidhedeijcfkFikikhkiggkidhh1ehigcikaffkhkiggkidhh1hhigikekfiFkFikcidhh1hitcikggikhkfkicjicghiediaikggikhkijbjfejfeFhaikggifikiggkigiejkikgkgieeigikggiffiggkigieeigekijcijikggifikiggkideedeijkefkfckikhkiggkidhh1ehijcikaffkhkiggkidhh1hhigikhkikFikfckcidhh1hiaikgjikhfjicjicgiehdikcikggifikigiejfejkieFhegikggifikiggfghigkfjeijkhigikggifikiggkigieeijcijcikfksikifikiggkidehdeijcfdckikhkiggkhghh1ehijikifffffkhsFngErD1pAfBoDd1BlEtFqA2AqoEpDqElAEsEeB2BmADlDkqBtC1FnEpDqnEmFsFsAFnllBbFmDsDiCtDmAB2BmtCgpEplCpAEiBiEoFqFtEqsDcCnFtADnFlEgdkEgmEtEsCtDmADqFtAFrAtEcCqAE1BoFqC1F1DrFtBmFtAC2ACnFaoCgADcADcCcFfoFtDlAFgmFqBq2bpEoAEmkqnEeCtAE1bAEqgDfFfCrgEcBrACfAAABqAAB1AAClEnFeCtCgAADqDoBmtAAACbFiAAADsEtBqAB2FsDqpFqEmFsCeDtFlCeDtoEpClEqAAFrAFoCgFmFsFqEnAEcCqFeCtFtEnAEeFtAAEkFnErAABbFkADnAAeCtFeAfBoAEpFtAABtFqAApDcCGJ"),this.SSQ.QB=this.jieya("FrcFs22AFsckF2tsDtFqEtF1posFdFgiFseFtmelpsEfhkF2anmelpFlF1ikrotcnEqEq2FfqmcDsrFor22FgFrcgDscFs22FgEeFtE2sfFs22sCoEsaF2tsD1FpeE2eFsssEciFsFnmelpFcFhkF2tcnEqEpFgkrotcnEqrEtFermcDsrE222FgBmcmr22DaEfnaF222sD1FpeForeF2tssEfiFpEoeFssD1iFstEqFppDgFstcnEqEpFg11FscnEqrAoAF2ClAEsDmDtCtBaDlAFbAEpAAAAAD2FgBiBqoBbnBaBoAAAAAAAEgDqAdBqAFrBaBoACdAAf1AACgAAAeBbCamDgEifAE2AABa1C1BgFdiAAACoCeE1ADiEifDaAEqAAFe1AcFbcAAAAAF1iFaAAACpACmFmAAAAAAAACrDaAAADG0")},calc(i,t){var h,e,s;i+=2451545;var a=this.SSQ.suoKB,r=14;"气"==t&&(a=this.SSQ.qiKB,r=7);var n=a[0]-r,c=a[a.length-1]-r;if(i<n||i>=2436935)return"气"==t?Math.floor(this.qi_high(Math.floor((i+r-2451259)/365.2422*24)*Math.PI/12)+.5):Math.floor(this.so_high(Math.floor((i+r-2451551)/29.5306)*Math.PI*2)+.5);if(i>=n&&i<c){for(h=0;h<a.length&&!(i+r<a[h+2]);h+=2);return e=a[h]+a[h+1]*Math.floor((i+r-a[h])/a[h+1]),1683460==(e=Math.floor(e+.5))&&e++,e-2451545}return i>=c&&i<2436935?("气"==t?(e=Math.floor(this.qi_low(Math.floor((i+r-2451259)/365.2422*24)*Math.PI/12)+.5),s=this.SSQ.QB.substr(Math.floor((i-c)/365.2422*24),1)):(e=Math.floor(this.so_low(Math.floor((i+r-2451551)/29.5306)*Math.PI*2)+.5),s=this.SSQ.SB.substr(Math.floor((i-c)/29.5306),1)),"1"==s?e+1:"2"==s?e-1:e):void 0},_JD:{Y:2e3,M:1,D:1,h:12,m:0,s:0,Weeks:new Array("日","一","二","三","四","五","六","七")},JD(i,t,h){var e=0,s=0;return 372*i+31*t+this.int2(h)>=588829&&(s=1),t<=2&&(t+=12,i--),s&&(e=2-(e=this.int2(i/100))+this.int2(e/4)),this.int2(365.25*(i+4716))+this.int2(30.6001*(t+1))+h+e-1524.5},DD(i){var t,h=new Object,e=this.int2(i+.5),s=i+.5-e;return e>=2299161&&(e+=1+(t=this.int2((e-1867216.25)/36524.25))-this.int2(t/4)),e+=1524,h.Y=this.int2((e-122.1)/365.25),e-=this.int2(365.25*h.Y),h.M=this.int2(e/30.601),e-=this.int2(30.601*h.M),h.D=e,h.M>13?(h.M-=13,h.Y-=4715):(h.M-=1,h.Y-=4716),s*=24,h.h=this.int2(s),s-=h.h,s*=60,h.m=this.int2(s),s-=h.m,s*=60,h.s=s,h},DD2str(i){var t="     "+i.Y,h="0"+i.M,e="0"+i.D,s=i.h,a=i.m,r=this.int2(i.s+.5);return r>=60&&(r-=60,a++),a>=60&&(a-=60,s++),s="0"+s,a="0"+a,r="0"+r,(t=t.substr(t.length-5,5))+"-"+(h=h.substr(h.length-2,2))+"-"+(e=e.substr(e.length-2,2))+" "+(s=s.substr(s.length-2,2))+":"+(a=a.substr(a.length-2,2))+":"+(r=r.substr(r.length-2,2))},JD2str(i){var t=this.DD(i);return this.DD2str(t)},toJD(){return this.JD(this._JD.Y,this._JD.M,this._JD.D+((this._JD.s/60+this._JD.m)/60+this._JD.h)/24)},setFromJD(i){var t=this.DD(i);this._JD.Y=t.Y,this._JD.M=t.M,this._JD.D=t.D,this._JD.m=t.m,this._JD.h=t.h,this._JD.s=t.s},timeStr(i){var t,h,e;return i+=.5,i-=this.int2(i),e=this.int2(86400*i+.5),e-=3600*(t=this.int2(e/3600)),e-=60*(h=this.int2(e/60)),h="0"+h,e="0"+e,(t="0"+t).substr(t.length-2,2)+":"+h.substr(h.length-2,2)+":"+e.substr(e.length-2,2)},getWeek(i){return this.int2(i+1.5+7e6)%7},nnweek(i,t,h,e){var s=this.JD(i,t,1.5),a=(s+1+7e6)%7,r=s-a+7*h+e;return e>=a&&(r-=7),5==h&&(++t>12&&(t=1,i++),r>=this.JD(i,t,1.5)&&(r-=7)),r},E_Lon(i,t){return this.XL0_calc(0,0,i,t)},M_Lon(i,t){return this.XL1_calc(0,i,t)},E_v(i){var t=628.307585*i;return 628.332+21*Math.sin(1.527+t)+.44*Math.sin(1.48+2*t)+.129*Math.sin(5.82+t)*i+55e-5*Math.sin(4.21+t)*i*i},M_v(i){var t=8399.71-914*Math.sin(.7848+8328.691425*i+1523e-7*i*i);return t-=179*Math.sin(2.543+15542.7543*i)+160*Math.sin(.1874+7214.0629*i)+62*Math.sin(3.14+16657.3828*i)+34*Math.sin(4.827+16866.9323*i)+22*Math.sin(4.9+23871.4457*i)+12*Math.sin(2.59+14914.4523*i)+7*Math.sin(.23+6585.7609*i)+5*Math.sin(.9+25195.624*i)+5*Math.sin(2.32-7700.3895*i)+5*Math.sin(3.88+8956.9934*i)+5*Math.sin(.49+7771.3771*i)},MS_aLon(i,t,h){return this.M_Lon(i,t)+this.gxc_moonLon(i)-(this.E_Lon(i,h)+this.gxc_sunLon(i)+Math.PI)},S_aLon(i,t){return this.E_Lon(i,t)+this.nutationLon2(i)+this.gxc_sunLon(i)+Math.PI},E_Lon_t(i){var t,h=628.3319653318;return t=(i-1.75347)/h,h=this.E_v(t),t+=(i-this.E_Lon(t,10))/h,h=this.E_v(t),t+=(i-this.E_Lon(t,-1))/h},M_Lon_t(i){var t,h=8399.70911033384;return t=(i-3.81034)/h,t+=(i-this.M_Lon(t,3))/h,h=this.M_v(t),t+=(i-this.M_Lon(t,20))/h,t+=(i-this.M_Lon(t,-1))/h},MS_aLon_t(i){var t,h=7771.37714500204;return t=(i+1.08472)/h,t+=(i-this.MS_aLon(t,3,3))/h,h=this.M_v(t)-this.E_v(t),t+=(i-this.MS_aLon(t,20,10))/h,t+=(i-this.MS_aLon(t,-1,60))/h},S_aLon_t(i){var t,h=628.3319653318;return t=(i-1.75347-Math.PI)/h,h=this.E_v(t),t+=(i-this.S_aLon(t,10))/h,h=this.E_v(t),t+=(i-this.S_aLon(t,-1))/h},MS_aLon_t2(i){var t,h=7771.37714500204,e=(t=(i+1.08472)/h)*t;return t-=(-3309e-8*e+.10976*Math.cos(.784758+8328.6914246*t+152292e-9*e)+.02224*Math.cos(.1874+7214.0628654*t-21848e-8*e)-.03342*Math.cos(4.669257+628.307585*t))/h,t+=(i-(this.M_Lon(t,20)-(4.8950632+628.3319653318*t+5297e-9*t*t+.0334166*Math.cos(4.669257+628.307585*t)+2061e-7*Math.cos(2.67823+628.307585*t)*t+349e-6*Math.cos(4.6261+1256.61517*t)-20.5/this.rad)))/(h=7771.38-914*Math.sin(.7848+8328.691425*t+1523e-7*t*t)-179*Math.sin(2.543+15542.7543*t)-160*Math.sin(.1874+7214.0629*t))},S_aLon_t2(i){var t,h=628.3319653318;return t=(i-1.75347-Math.PI)/h,t-=(5297e-9*t*t+.0334166*Math.cos(4.669257+628.307585*t)+2061e-7*Math.cos(2.67823+628.307585*t)*t)/h,t+=(i-this.E_Lon(t,8)-Math.PI+(20.5+17.2*Math.sin(2.1824-33.75705*t))/this.rad)/h},moonIll(i){var t,h,e,s,a=i*i,r=a*i,n=r*i,c=Math.PI/180;return t=(297.8502042+445267.1115168*i-.00163*a+r/545868-n/113065e3)*c,h=(357.5291092+35999.0502909*i-1536e-7*a+r/2449e4)*c,e=(134.9634114+477198.8676313*i+.008997*a+r/69699-n/14712e3)*c,s=Math.PI-t+(-6.289*Math.sin(e)+2.1*Math.sin(h)-1.274*Math.sin(2*t-e)-.658*Math.sin(2*t)-.214*Math.sin(2*e)-.11*Math.sin(t))*c,(1+Math.cos(s))/2},moonRad(i,t){return this.cs_sMoon()/i*(1+Math.sin(t)*this.cs_rEar/i)},moonMinR(i,t){var h,e,s,a,r,n=27.55454988/36525;return i=(h=t?-10.3302/36525:3.4471/36525)+n*this.int2((i-h)/n+.5),r=1/36525,e=this.XL1_calc(2,i-r,10),s=this.XL1_calc(2,i,10),i+=(e-(a=this.XL1_calc(2,i+r,10)))/(e+a-2*s)*r/2,r=.5/36525,e=this.XL1_calc(2,i-r,20),s=this.XL1_calc(2,i,20),i+=(e-(a=this.XL1_calc(2,i+r,20)))/(e+a-2*s)*r/2,r=1200/86400/36525,e=this.XL1_calc(2,i-r,-1),s=this.XL1_calc(2,i,-1),i+=(e-(a=this.XL1_calc(2,i+r,-1)))/(e+a-2*s)*r/2,s+=(e-a)/(e+a-2*s)*(a-e)/8,new Array(i,s)},moonNode(i,t){var h,e,s,a,r=27.21222082/36525;return i=(h=t?21/36525:35/36525)+r*this.int2((i-h)/r+.5),a=.5/36525,i-=(e=this.XL1_calc(1,i,10))/(s=(this.XL1_calc(1,i+a,10)-e)/a),a=.05/36525,i-=(e=this.XL1_calc(1,i,40))/(s=(this.XL1_calc(1,i+a,40)-e)/a),i-=(e=this.XL1_calc(1,i,-1))/s,new Array(i,this.XL1_calc(0,i,-1))},earthMinR(i,t){var h,e,s,a,r,n=365.25963586/36525;return i=(h=t?1.7/36525:184.5/36525)+n*this.int2((i-h)/n+.5),r=3/36525,e=this.XL0_calc(0,2,i-r,10),s=this.XL0_calc(0,2,i,10),i+=(e-(a=this.XL0_calc(0,2,i+r,10)))/(e+a-2*s)*r/2,r=.2/36525,e=this.XL0_calc(0,2,i-r,80),s=this.XL0_calc(0,2,i,80),i+=(e-(a=this.XL0_calc(0,2,i+r,80)))/(e+a-2*s)*r/2,r=.01/36525,e=this.XL0_calc(0,2,i-r,-1),s=this.XL0_calc(0,2,i,-1),i+=(e-(a=this.XL0_calc(0,2,i+r,-1)))/(e+a-2*s)*r/2,s+=(e-a)/(e+a-2*s)*(a-e)/8,new Array(i,s)}};